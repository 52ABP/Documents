>  本文出自《从零开始学ASP.NET CORE MVC》 </br>
> 视频课程效果更佳：[从零开始学Asp.Net Core MVC](https://study.163.com/course/courseMain.htm?courseId=1209215803&share=2&shareId=400000000309007)  </br>
# 在asp.net Core 中安装MVC

在本视频中，我们将讨论在ASP.NET Core应用程序中设置MVC。

到目前为止，我们在本系列视频中使用的ASP.NET Core项目是使用“空”项目模板生成的。目前这个项目没有设置和安装MVC。

## 两个步骤学会在ASP.NET Core配置MVC

 步骤1：在Startup.cs文件中的Startup类的**ConfigureServices()**方法中,见下方代码。 这行代码将所需的MVC服务添加到asp.net core中的依赖注入容器中。
``` csharp
services.AddMvc();
```
步骤2：在Configure()方法中，将**UseMvcWithDefaultRoute()**中间件添加到我们的应用程序的请求处理管道中。 修改代码，如下所示。
```
public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
    }

    app.UseStaticFiles();

    app.UseMvcWithDefaultRoute();

    app.Run(async (context) =>
    {
        await context.Response.WriteAsync("Hello World!");
    });
}
```
注意，我们在**UseMvcWithDefaultRoute()**中间件之前放置了**UseStaticFiles()**中间件。 此顺序很重要，因为如果请求是针对静态文件（如图像，CSS或JavaScript文件），则**UseStaticFiles()**中间件将处理请求并使管道的其余部分短路。

因此, 如果请求是针对静态文件, 则不会执行**UseMvcWithDefaultRoute () **中间件, 从而避免不必要的处理。

另一方面, 如果请求是 MVC 请求, **UseStaticFiles ()**中间件将把该请求传递给 **UseMvcWithDefaultRoute()** 中间件, 中间件将处理请求并生成响应。

请注意, 除了**UseMvcWithDefaultRoute ()** 中间件之外, 我们还有**UseMvc ()**中间件。现在, 让我们使用 **UseMvcWithDefaultRoute()** 中间件。

> 在我们即将推出的视频中, 当我们讨论路由时, 我们将讨论这两个中间件之间的区别。
 
此时，如果我们运行应用程序并导航到URL -http://localhost:49119，我们会看到“Hello World！” 消息显示在浏览器中。

- 使用管道中配置的UseMvcWithDefaultRoute()中间件，当我们向URL发出请求时 -  http://localhost:49119

- 由于请求不是针对静态文件，因此UseStaticFiles()中间件会将请求传递给UseMvcWithDefaultRoute()中间件

- 由于我们尚未在URL中指定控制器和操作方法段，因此UseMvcWithDefaultRoute()中间件在HomeController中查找Index()方法。

- 由于目前我们的应用程序中没有HomeController，因此UseMvcWithDefaultRoute()中间件将请求传递给使用Run()方法注册的中间件，因此我们看到“Hello World！” 此中间件生成的消息。

现在让我们看看，如果我们删除Run（）中间件会发生什么。 此时，Configure（）方法中的代码必须如下所示。

```
public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
    }

    app.UseStaticFiles();

    app.UseMvcWithDefaultRoute();
}
```
有了上面的代码，如果我们再次向URL发出请求 -  http：// localhost：49119，我们现在看到404错误。 这是因为UseMvcWithDefaultRoute（）中间件没有找到带有Index（）动作的HomeController，并且管道中没有其他中间件，所以我们看到404错误。

## 添加 HomeController

在项目根文件夹中添加Controllers文件夹。 在“控制器”中添加一个新的控制器。 复制并粘贴以下代码。
```
public class HomeController
{
    public string Index()
    {
        return "Hello from MVC";
    }
}
```

生成解决方案并向应用程序URL发出请求 -  http：// localhost：49119。 现在，您将看到浏览器中显示的字符串 - “Hello from MVC”。
 



































# 声明


> 如果您觉得我的文章质量还不错，欢迎打赏，也可以订阅我的视频哦 </br>
> 未得到授权不得擅自转载本文内容,52abp.com保留版权</br>
> 文字版目录： [https://www.52abp.com/Wiki/mvc/latest/1.Intro](https://www.52abp.com/Wiki/mvc/latest/1.Intro) </br>
> 交流QQ群：952387474 点击链接加入QQ群[《微软MVP带你学ASP.NET CORE》](https://jq.qq.com/?_wv=1027&k=5nq4PFQ)</br>
> 【收费】腾讯课堂:[https://ke.qq.com/course/392589?tuin=2522cdf3](https://ke.qq.com/course/392589?tuin=2522cdf3) </br>
> 【免费】youtube视频专区：[http://t.cn/Ei0F2EB](http://t.cn/Ei0F2EB) </br>
>
>免费的更新慢，收费的更新快，仅此而已。就这样。 </br>

## 关注微信公众号：角落的白板报
![公众号：角落的白板报](https://upload-images.jianshu.io/upload_images/1979022-f19c505c18160c16.png)









